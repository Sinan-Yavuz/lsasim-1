#' @title Sample from population structure
#' @description Generates a sample from a population structure
sample_from <- function (N, n, labels = names(N))
{
  # Creating basic elements ====================================================
  if (class(N) != "list") N <- convert_vector_to_list(N)
  unit_labels <- label_respondents(N, labels)
  sampled_units <- unit_labels

  # Sampling elements until second-to-last level ===============================
  for (l in seq(from = 1, to = length(n) - 1)) {
    subunit_labels <- unique(unit_labels[, l])
    selected_subunit <- sample(x = subunit_labels, size = n[l])
    selected_rows <- sampled_units[, l] %in% selected_subunit
    sampled_units <- sampled_units[selected_rows, , drop = FALSE]
  }

  # Sampling from last level ===================================================
  # lapply(sampled_units, 1, function(x) sample(n[length(n))
  draw_cluster_structure(N, labels)
  draw_cluster_structure(N, labels, output = "text")
}